SQL,filename
"CREATE TABLE Currents AS  ( select marsha, stay_year, coalesce( crossover_rms,0) AS CO_RN_Goal, coalesce( ( crossover_rms*crossover_gadr),0) AS CO_Rev_Goal, def_rms AS Def_OTB, ( def_rms*def_gadr) AS Def_Rev, CID_Rms AS Target, Avg_rms AS Avg_Bkd FROM AW_TGT_BUS_DBO.OY_ANNUALCROSSOVER WHERE stay_year < &YEARNXT3 AND ASOF_YRMO=&CURYRPD ORDER BY marsha, stay_year) ;",7_CrossOverData.sas
"CREATE TABLE Futures AS  ( select marsha, 'Futures' AS Stay_Year, coalesce( SUM( crossover_rms),0) AS CO_RN_Goal, coalesce( SUM( crossover_rms*def_gadr),0) AS CO_Rev_Goal, SUM( def_rms) AS Def_OTB, SUM( def_rms*def_gadr) AS Def_Rev, SUM( cid_rms) AS Target, SUM( avg_rms) AS Avg_Bkd FROM AW_TGT_BUS_DBO.OY_ANNUALCROSSOVER WHERE stay_year > &curyr AND ASOF_YRMO=&CURYRPD GROUP BY marsha ORDER BY marsha) ;",7_CrossOverData.sas
"CREATE TABLE merge_CrossOver1 AS ( SELECT  *, marsha AS marsha2, FORMAT(stay_year, VARCHAR(7)) AS stay_year , marsha2 AS marsha , CASE WHEN  CO_Rev_Goal=' ' OR CO_Rev_Goal=' ' OR CO_RN_Goal=0 OR CO_Rev_Goal=0  THEN 0 ELSE CO_Rev_Goal/CO_RN_Goal END AS CO_RN_Goal_ADR, CASE WHEN  Def_OTB=' ' OR Def_REV=' ' OR Def_OTB=' ' OR Def_REV=0  THEN 0 ELSE Def_REV/Def_OTB END AS Def_ADR FROM Currents A JOIN Futures B ON  A.marsha2 =  B.marsha2 AND  A.stay_year =  B.stay_year);",7_CrossOverData.sas
ALTER TABLE merge_CrossOver1 DROP COLUMN marsha2 ;,7_CrossOverData.sas
 CREATE TABLE sfodata.CrossOver_YTD AS ( SELECT  *  FROM merge_CrossOver1 );,7_CrossOverData.sas
"CREATE TABLE PLU AS  (  SELECT a.*, b.ERS2_USER FROM AW_TGT_BUS_DBO.PROPERTY_MASTER A LEFT JOIN AW_TGT_PROXY_DBO.IT_OY_PROP_CD_WEEKLY B ON a.marsha=b.prop_code WHERE openflag = 'Y' AND project_status='Open' AND interface='2' ) ;",7_SRL_data.sas
CREATE TABLE UAT1_d AS  (  SELECT a.* FROM AW_TGT_PROXY_DBO.IT_SCE8_POP_STD_RM_CAP_HIST AS a INNER JOIN ( select max( data_dt) AS maxdate FROM AW_TGT_PROXY_DBO.IT_SCE8_POP_STD_RM_CAP_HIST) AS b ON a.data_dt=b.maxdate WHERE a.set_status='ON' ) ;,7_SRL_data.sas
"CREATE TABLE data_2a AS select distinct prop_code,EXTRACT(YEAR FROM stay_dt) AS year,EXTRACT(MONTH FROM stay_dt) AS month, COUNT( user_capped) AS cap_ct FROM uat1_d GROUP BY prop_code, year, month;",7_SRL_data.sas
"CREATE TABLE data_3a AS select distinct prop_code,EXTRACT(YEAR FROM stay_dt) AS year,EXTRACT(MONTH FROM stay_dt) AS month, COUNT( user_capped) AS act_ct FROM uat1_d WHERE act_status='Y' GROUP BY prop_code, year, month;",7_SRL_data.sas
"CREATE TABLE srl_data AS select b.*, coalesce( c.act_ct, 0) AS act_ct FROM data_2a AS b LEFT JOIN data_3a AS c ON b.prop_code=c.prop_code AND b.year=c.year AND b.month=c.month ORDER BY b.prop_code, b.year, b.month;",7_SRL_data.sas
 CREATE TABLE srl;,7_SRL_data.sas
CREATE TABLE 'G:\RM EAnlys\Shared_Data\OYSData\Standard Room Limit Data\RMSAD Data\srl_data_&yrmn..csv' AS ( SELECT * FROM srl_data) ;,7_SRL_data.sas
"CREATE TABLE Currents AS  ( select marsha, stay_year, coalesce( crossover_rms,0) AS CO_RN_Goal, coalesce( ( crossover_rms*crossover_gadr),0) AS CO_Rev_Goal, def_rms AS Def_OTB, ( def_rms*def_gadr) AS Def_Rev, CID_Rms AS Target, Avg_rms AS Avg_Bkd FROM AW_TGT_BUS_DBO.OY_ANNUALCROSSOVER WHERE stay_year < &YEARNXT3 AND ASOF_YRMO=&CURYRPD ORDER BY marsha, stay_year) ;",Americas_7_CrossOverData.sas
"CREATE TABLE Futures AS  ( select marsha, 'Futures' AS Stay_Year, coalesce( SUM( crossover_rms),0) AS CO_RN_Goal, coalesce( SUM( crossover_rms*def_gadr),0) AS CO_Rev_Goal, SUM( def_rms) AS Def_OTB, SUM( def_rms*def_gadr) AS Def_Rev, SUM( cid_rms) AS Target, SUM( avg_rms) AS Avg_Bkd FROM AW_TGT_BUS_DBO.OY_ANNUALCROSSOVER WHERE stay_year > &curyr AND ASOF_YRMO=&CURYRPD GROUP BY marsha ORDER BY marsha) ;",Americas_7_CrossOverData.sas
"CREATE TABLE merge_CrossOver1 AS ( SELECT  *, marsha AS marsha2, FORMAT(stay_year, VARCHAR(7)) AS stay_year , marsha2 AS marsha , CASE WHEN  CO_Rev_Goal=' ' OR CO_Rev_Goal=' ' OR CO_RN_Goal=0 OR CO_Rev_Goal=0  THEN 0 ELSE CO_Rev_Goal/CO_RN_Goal END AS CO_RN_Goal_ADR, CASE WHEN  Def_OTB=' ' OR Def_REV=' ' OR Def_OTB=' ' OR Def_REV=0  THEN 0 ELSE Def_REV/Def_OTB END AS Def_ADR FROM Currents A JOIN Futures B ON  A.marsha2 =  B.marsha2 AND  A.stay_year =  B.stay_year);",Americas_7_CrossOverData.sas
ALTER TABLE merge_CrossOver1 DROP COLUMN marsha2 ;,Americas_7_CrossOverData.sas
 CREATE TABLE sfodata.CrossOver_YTD AS ( SELECT  *  FROM merge_CrossOver1 );,Americas_7_CrossOverData.sas
"CREATE TABLE HAWAII_PROPS AS  ( SELECT MARSHACODE AS MARSHA, 'Hawaii' AS ORG_NAME FROM HICALAPROPDICT WHERE MONTH = &SHORTPD AND YEAR = &CURYR AND UPPER( REGION) = 'HAWAII'  ) ;",Americas_Archive_Hawaii_Property_List.sas
"CREATE TABLE HI_PROPS AS SELECT A.ORG_NAME, B.BRND AS BRAND, B.BRND_NAME AS BRAND_NAME, A.MARSHA, B.HOTEL_NAME AS PROPERTY_NAME, B.MISW_FLAG FROM HAWAII_PROPS A INNER JOIN AWPROD.PROPERTY_MASTER B ON A.MARSHA=B.MARSHA ORDER BY A.MARSHA ;",Americas_Archive_Hawaii_Property_List.sas
CREATE TABLE '&SWPROPS.\Hotel List Archive\Hawaii_Property_List_&NXTPD..xlsb AS ( SELECT * FROM HI_PROPS) ;,Americas_Archive_Hawaii_Property_List.sas
"CREATE TABLE AW_TGT_BUS_DBO.STR_STARVIEW_COMP_STG (  MARSHA  VARCHAR( 5), STAR_ID BIGINT, SCOMP VARCHAR( 1), ASOF_YRMO INTEGER )  ;",AW_load_Star_Comp_Load.sas
"CREATE TABLE work.starcomp AS ( SELECT  *, COMP AS SCOMP, &STARMNTH AS ASOF_YRMO , STR_ID AS STAR_ID  FROM Str_acc.Starview_Comp_CD );",AW_load_Star_Comp_Load.sas
ALTER TABLE work.starcomp DROP COLUMN STR_ID ;,AW_load_Star_Comp_Load.sas
INSERT INTO TABLE AWPROD.STR_STARVIEW_COMP_STG SELECT * FROM work.starcomp;,AW_load_Star_Comp_Load.sas
  INSERT INTO AW_TGT_BUS_DBO.STR_STARVIEW_COMP Select * FROM AW_TGT_BUS_DBO.STR_STARVIEW_COMP_STG  ;,AW_load_Star_Comp_Load.sas
  DROP TABLE AW_TGT_BUS_DBO.STR_STARVIEW_COMP_STG;,AW_load_Star_Comp_Load.sas
